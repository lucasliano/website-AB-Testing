{# templates/partials/detail_header.html #}
<section class="mt-4">
  <div class="grid grid-cols-1 lg:grid-cols-[minmax(0,2fr)_minmax(0,1.3fr)] gap-10 mt-6">

    <!-- COLUMNA IZQUIERDA: VOLVER + TÍTULO + SHORT DESCRIPTION + STATUS -->
    <div>
      <a
        href="{{ url_for('home') }}"
        class="inline-flex items-center gap-1 rounded-full border border-slate-700/70 bg-slate-900/60 px-3 py-1 text-xs text-slate-200 hover:bg-slate-800 transition"
        data-event-name="click_volver_detail-header"
      >
        ← Volver
      </a>

      <h1 class="mt-4 text-4xl md:text-5xl font-extrabold text-white">
        {{ initiative.title }}
      </h1>

      {% if initiative.short_description %}
        <div class="mt-3 max-w-xl">
          <p class="text-xs font-semibold uppercase tracking-wide text-slate-400">
            Objetivo general
          </p>
          <p class="mt-1 text-base md:text-lg text-slate-300">
            {{ initiative.short_description }}
          </p>
        </div>
      {% endif %}

      {% if initiative.status_label %}
        {% set status_type = initiative.status_type or initiative.status %}
        {% if status_type == 'idea' %}
          {% set status_classes = "bg-amber-400 text-slate-900" %}
        {% elif status_type in ['proyecto', 'project'] %}
          {% set status_classes = "bg-sky-500 text-slate-900" %}
        {% else %}
          {% set status_classes = "bg-slate-200 text-slate-900" %}
        {% endif %}
        <span
          class="inline-flex mt-4 items-center rounded-full px-4 py-1 text-xs font-semibold {{ status_classes }}"
        >
          {{ initiative.status_label }}
        </span>
      {% endif %}
    </div>

    <!-- COLUMNA DERECHA: RESUMEN -->
    <aside
      class="bg-gradient-to-b from-slate-900 to-slate-950 border border-slate-800 rounded-3xl p-6 shadow-[0_20px_60px_rgba(0,0,0,0.7)]"
    >
      <h2 class="text-sm font-semibold text-slate-100 mb-4 border-b border-slate-700/80 pb-2 uppercase tracking-wide">
        Resumen
      </h2>

      <dl class="space-y-4 text-sm">

        <!-- RESPONSABLE -->
        <div>
          <dt class="text-xs font-semibold text-slate-100 uppercase tracking-wide">
            Responsable
          </dt>
          <dd class="mt-1 text-sm text-slate-300">
            {% if initiative.responsable %}
              {% if initiative.responsable is string %}
                <p>{{ initiative.responsable }}</p>
              {% else %}
                <ul class="space-y-1">
                  {% for r in initiative.responsable %}
                    <li>• {{ r }}</li>
                  {% endfor %}
                </ul>
              {% endif %}
            {% else %}
              <span class="text-slate-500">No definido</span>
            {% endif %}
          </dd>
        </div>

        <!-- CORREO DE CONTACTO -->
        <div>
          <dt class="text-xs font-semibold text-slate-100 uppercase tracking-wide">
            Correo de contacto
          </dt>
          <dd class="mt-1 text-sm text-slate-300">
            {% if initiative.contact_email %}
              {% if initiative.contact_email is string %}
                <a
                  href="mailto:{{ initiative.contact_email }}"
                  class="text-sky-400 hover:text-sky-300 break-all"
                >
                  {{ initiative.contact_email }}
                </a>
              {% else %}
                <ul class="space-y-1">
                  {% for email in initiative.contact_email %}
                    <li>
                      <a
                        href="mailto:{{ email }}"
                        class="text-sky-400 hover:text-sky-300 break-all"
                      >
                        {{ email }}
                      </a>
                    </li>
                  {% endfor %}
                </ul>
              {% endif %}
            {% else %}
              <span class="text-slate-500">No informado</span>
            {% endif %}
          </dd>
        </div>

        <!-- CATEGORÍAS -->
        <div>
          <dt class="text-xs font-semibold text-slate-100 uppercase tracking-wide">
            Categorías
          </dt>
          <dd class="mt-1">
            <div class="flex flex-wrap gap-2">
              {% if initiative.categories %}
                {% for category in initiative.categories %}
                  <span class="inline-flex items-center rounded-full border border-slate-700/80 bg-slate-950/60 px-3 py-1 text-xs font-medium text-slate-200">
                    {{ category }}
                  </span>
                {% endfor %}
              {% else %}
                <span class="text-slate-500">Sin categorías</span>
              {% endif %}
            </div>
          </dd>
        </div>

        <!-- ESTÁ BUSCANDO -->
        <div>
          <dt class="text-xs font-semibold text-slate-100 uppercase tracking-wide">
            Está buscando
          </dt>
          <dd class="mt-1 text-sm text-slate-300">
            {% if initiative.looking_for %}
              {{ initiative.looking_for }}
            {% else %}
              <span class="text-slate-500">No especificado</span>
            {% endif %}
          </dd>
        </div>
      </dl>

      {% if initiative.contact_email %}
        <button
          type="button"
          class="mt-6 inline-flex w-full items-center justify-center rounded-full bg-gradient-to-r from-sky-500 to-blue-600 text-sm font-semibold text-white py-2.5 shadow-lg hover:from-sky-400 hover:to-blue-500 hover:scale-[1.01] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-sky-400 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-950 transition"
          data-event-name="click_contactar_resumen-detalle"
          data-initiative-contact="{{ initiative.id }}"
          data-modal-open="contact-form"
        >
          Contactar responsable
        </button>
      {% endif %}
    </aside>
  </div>

  {# MODAL CONTACTO RESPONSABLE - TAILWIND DIALOG #}
  <div
    class="fixed inset-0 z-40 flex items-center justify-center px-4 py-6 hidden"
    data-modal="contact-form"
    aria-hidden="true"
  >
    <!-- Overlay -->
    <div
      class="absolute inset-0 bg-black/70 backdrop-blur-sm"
      data-modal-overlay
      data-event-name="click_overlay_contact-form"
    ></div>

    <!-- Contenedor modal -->
    <div
      class="relative z-50 w-full max-w-xl rounded-3xl bg-gradient-to-b from-slate-900 to-slate-950 border border-slate-700/80 shadow-[0_30px_80px_rgba(0,0,0,0.9)] px-6 py-6 md:px-8 md:py-7"
      role="dialog"
      aria-modal="true"
      aria-labelledby="contact-form-title"
    >
      <!-- Header modal -->
      <div class="flex items-center justify-between mb-5">
        <h2 id="contact-form-title" class="text-lg font-semibold text-white">
          Contactar responsable de la iniciativa
        </h2>

        <button
          type="button"
          class="inline-flex items-center justify-center rounded-full p-2 text-slate-400 hover:text-white hover:bg-slate-800/60 transition"
          data-modal-close
          aria-label="Cerrar formulario de contacto"
        >
          <svg class="h-4 w-4" viewBox="0 0 16 16" fill="none" aria-hidden="true">
            <path d="M4 4l8 8m0-8L4 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
          </svg>
        </button>
      </div>

      <!-- FORMULARIO -->
      <form
        class="space-y-4"
        action="#"
        method="post"
        enctype="multipart/form-data"
      >
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <!-- Nombre -->
          <div>
            <label class="block text-xs font-medium text-slate-300 mb-1" for="contact-nombre">
              Nombre
            </label>
            <input
              id="contact-nombre"
              name="nombre"
              type="text"
              class="block w-full rounded-xl border border-slate-700/70 bg-slate-900/70 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500"
              placeholder="Tu nombre"
              required
            >
          </div>

          <!-- Apellido -->
          <div>
            <label class="block text-xs font-medium text-slate-300 mb-1" for="contact-apellido">
              Apellido
            </label>
            <input
              id="contact-apellido"
              name="apellido"
              type="text"
              class="block w-full rounded-xl border border-slate-700/70 bg-slate-900/70 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500"
              placeholder="Tu apellido"
              required
            >
          </div>
        </div>

        <!-- Mail -->
        <div>
          <label class="block text-xs font-medium text-slate-300 mb-1" for="contact-email">
            Mail
          </label>
          <input
            id="contact-email"
            name="email"
            type="email"
            class="block w-full rounded-xl border border-slate-700/70 bg-slate-900/70 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500"
            placeholder="tu@mail.com"
            required
          >
        </div>

        <!-- Carrera -->
        <div>
          <label class="block text-xs font-medium text-slate-300 mb-1" for="contact-carrera">
            Carrera
          </label>
          <input
            id="contact-carrera"
            name="carrera"
            type="text"
            class="block w-full rounded-xl border border-slate-700/70 bg-slate-900/70 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500"
            placeholder="Carrera que estás cursando"
          >
        </div>

        <!-- Iniciativa -->
        <div>
          <label class="block text-xs font-medium text-slate-300 mb-1" for="contact-iniciativa">
            Iniciativa
          </label>
          <input
            id="contact-iniciativa"
            name="iniciativa"
            type="text"
            class="block w-full rounded-xl border border-slate-700/70 bg-slate-900/70 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500"
            placeholder="Nombre de la iniciativa"
            value="{{ initiative.title }}"
          >
        </div>

        <!-- Subir archivo -->
        <div>
          <label class="block text-xs font-medium text-slate-300 mb-1" for="contact-archivo">
            Subir archivo
          </label>
          <input
            id="contact-archivo"
            name="archivo"
            type="file"
            class="block w-full text-sm text-slate-200 file:mr-4 file:rounded-lg file:border-0 file:bg-sky-500 file:px-3 file:py-2 file:text-sm file:font-semibold file:text-slate-950 hover:file:bg-sky-400"
          >
        </div>

        <!-- Botón enviar -->
        <div class="pt-2">
          <button
            type="submit"
            class="inline-flex w-full items-center justify-center rounded-full bg-sky-500 px-4 py-2.5 text-sm font-semibold text-slate-950 shadow-lg shadow-sky-500/40 hover:bg-sky-400 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-sky-500 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-950 transition"
          >
            Enviar
          </button>
        </div>
      </form>
    </div>
  </div>
</section>
